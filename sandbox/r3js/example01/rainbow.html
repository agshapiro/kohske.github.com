<!doctype html>
<html lang="en">
  <head>
    <title>r3js</title>
    <meta charset="utf-8">
  </head>
  <body>
    <div id="info">
      <script src="Three.js"></script>
      <script>
	var r3jsdata = {"camera":[],"options":{"axisbox":false,"axisline":true},"xlim":[0,1],"ylim":[0,1],"values":[{"type":"sphere","n":20,"x":[0.728976545233401,0.414218472162141,0.532112739571614,0.277480276181584,0.801235221687955,0.114796748703043,1.02340748816211,0.428113992179448,0.381481473519072,0.64148953758859,0.740986403170792,0.652648877289016,0.479755482693671,0.31406986674785,0.514024720293048,0.500881192890259,0.791970301103398,0.672030459888264,0.426681645672569,0.672401608103123],"y":[0.109382929170435,0.818003644966449,0.332072403898785,0.710165283746086,0.515237206750735,0.610868724769642,0.381976672668727,0.307976319354164,0.547058289668477,0.494232779007797,0.280885820847199,0.0452502192222545,0.693313094324883,0.598643275466698,0.214544760857653,0.117780652187502,0.580251590949316,0.369454613445994,0.459205629716053,0.71857021158476],"z":[0.448488557087879,0.250808351080421,0.473132421277531,0.514720275548681,0.661724039129313,0.420159372924649,0.494586326524358,0.490100165428309,0.64496659289115,0.579034511099326,0.489795420973161,0.803184002988693,0.877678915872425,0.404629125443484,0.527508211223852,0.403442127150157,0.405979457090393,0.384593083394748,0.801370163145129,0.435504834947166],"r":[0.0352429644786753,0.033537294624839,0.0735519254975952,0.0889958444330841,0.0655561808007769,0.0609896081825718,0.0777384771034122,0.080356442341581,0.0539528943225741,0.0506337897130288,0.0771918516769074,0.0691278031980619,0.0900079127587378,0.043017394056078,0.0403161959350109,0.0525972493481822,0.0482585459365509,0.0536322838137858,0.083691283527296,0.0693366547347978],"col":[306169,11668021,2048755,13935385,14886828,15025336,12746568,16429804,11876001,13761538,9934753,969484,8894020,8676237,4852213,7055142,1487347,11326085,10648302,12483770],"alpha":[0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5]},{"type":"line","n":101,"x":[1,0.938791280945186,0.77015115293407,0.535368600833851,0.291926581726429,0.0994281922265332,0.00500375169977729,0.0317716563546019,0.173178189568194,0.39460210028461,0.641831092731613,0.85433488714563,0.980085143325183,0.988293812864012,0.876951127171652,0.673317658917513,0.427249983095693,0.198994048657588,0.0444348690576615,0.00141392190181078,0.0804642354617738,0.262231536002004,0.502212848994025,0.741652379376503,0.921926979366246,0.99889913958929,0.953723390725098,0.797460331654946,0.568368609103916,0.322537866605648,0.120156043570589,0.0107732685905579,0.0211702598383077,0.148801471248643,0.362418330974202,0.60971998160573,0.83015835412204,0.969762446874128,0.994352309093335,0.897907484906972,0.704041030906696,0.46021821636073,0.226135369887866,0.0591041362293379,1.95868026814372e-05,0.0633476799532422,0.233583489833301,0.46904735300279,0.712089503668498,0.903204746956127,0.995601405931737,0.966657556031961,0.82345966116432,0.601067560193591,0.353930595633082,0.142556515610166,0.0186970668432162,0.0126773621396715,0.125971235155499,0.330840394514472,0.577125724943792,0.804527988053178,0.957371178902266,0.998233953778562,0.917111680253255,0.733865920123537,0.49336162638847,0.25448263803488,0.0757148626076974,0.00082688627562888,0.0481538974542466,0.206108593219807,0.436018155186298,0.681592704208031,0.882707025972672,0.990121320405054,0.977536822023647,0.848034654931945,0.633321466179969,0.38596653275845,0.166530969173869,0.0287402544745585,0.00633036123808678,0.104788012901092,0.300007342505824,0.544191849652903,0.777556650760313,0.942965903634991,0.999921654323846,0.934479148656997,0.762660994408865,0.526534268107012,0.283911027557611,0.0941939038284877,0.00383226542453563,0.0349497928993554,0.1799278302654,0.403270697689644,0.650296271871819,0.860524076934041,0.982483014246057],"y":[0,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.1,0.11,0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19,0.2,0.21,0.22,0.23,0.24,0.25,0.26,0.27,0.28,0.29,0.3,0.31,0.32,0.33,0.34,0.35,0.36,0.37,0.38,0.39,0.4,0.41,0.42,0.43,0.44,0.45,0.46,0.47,0.48,0.49,0.5,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,0.6,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69,0.7,0.71,0.72,0.73,0.74,0.75,0.76,0.77,0.78,0.79,0.8,0.81,0.82,0.83,0.84,0.85,0.86,0.87,0.88,0.89,0.9,0.91,0.92,0.93,0.94,0.95,0.96,0.97,0.98,0.99,1],"z":[0.5,0.739712769302102,0.920735492403948,0.998747493302027,0.954648713412841,0.799236072051978,0.570560004029934,0.32460838615519,0.121598752346036,0.0112349411674515,0.0205378626684308,0.147229837214804,0.360292250900537,0.607559994043908,0.828493299359395,0.968999988387369,0.994679123311691,0.899243556311745,0.706059242620878,0.462424439769095,0.227989444555315,0.060152120014165,4.8967246482623e-06,0.0622739126557857,0.231713540999783,0.4668390513244,0.710083518413321,0.90189221327581,0.995303677847435,0.967447527762342,0.825143920078558,0.603233740968898,0.356048341667467,0.144107328815438,0.0193012540602216,0.0121869972659212,0.124506376614162,0.328759690765194,0.574938604831476,0.802769934859801,0.956472625363814,0.9984148971394,0.918327819268028,0.735819501547098,0.495574345354798,0.256412743769745,0.0768897979124147,0.000958986010301865,0.0472108189966881,0.204321235067438,0.433824124951113,0.679529177011084,0.881279225239801,0.989678821551959,0.978187964202252,0.849620015827548,0.635452894153933,0.3881221799066,0.168183057893518,0.0294842958285232,0.00598418795356909,0.103436380271357,0.297981177338468,0.541987227845873,0.775713340620845,0.941935211772915,0.999955930053634,0.935570000084588,0.764541343060012,0.528743739052462,0.285908665251924,0.0954906168940468,0.00411057327844211,0.0341415560726472,0.1782309333215,0.401100600181769,0.648184289354693,0.858987296385822,0.981897693142044,0.986822727847489,0.872556580239674,0.66707558842421,0.420688665597646,0.193719923512265,0.0417392260421831,0.00195674844020299,0.0841126286857009,0.268092242008086,0.508850962552707,0.747442658776314,0.925451762267059,0.999295436205885,0.950894173824405,0.792098292206643,0.561786561372612,0.316347325432904,0.115872669338167,0.00944578069845148,0.0231236736202641,0.153557522883152,0.368812573148036],"lwd":5,"col":[8815768,10091835,8185708,167529,14801347,13818246,5064130,13478974,12446475,6451125,4494935,14018849,6123377,7798037,4484861,13874439,8502675,9019078,14597688,1835809,10370080,11949210,5232217,4556877,596092,11548935,1705357,765793,16185034,2658392,6059341,2597892,16216872,15167718,9471872,562068,8990693,6531683,12526478,6222221,6140754,14541799,16578741,7027116,4061903,7564242,13763075,14478901,9729654,10316103,9001386,8394607,15290575,1554904,4035524,12581473,13841534,6062253,6633088,9896934,14883355,3534187,13177649,16317098,5520048,13839510,3319131,12840895,9485630,9439642,5960681,14246777,244697,10930805,3160977,4634374,10087380,15784054,3369635,12521339,2446259,7818819,1452093,14453381,6406362,9117296,15526839,1266612,13428278,9657894,9017722,9258878,7065507,15164709,11393037,8435725,14903619,805811,10598700,10835933,14950687],"alpha":0.7}]};
      </script>
      <script>
	var container;
var camera, scene, renderer, particles, geometry, materials = [], parameters, i, h, color;
var pointLight;
var mousedown = false;
var windowHalfX = window.innerWidth / 2;
var windowHalfY = window.innerHeight / 2;
var onMouseDownPosition, radius = 3, theta = 0, onMouseDownTheta = 0, phi = 0, onMouseDownPhi = 0;

init();
render()

function init() {

    container = document.createElement( 'div' );
    document.body.appendChild( container );

    scene = new THREE.Scene();

    if (r3jsdata.camera && r3jsdata.camera.radius) 
	radius = r3jsdata.camera.radius;

    camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 1, 3000 );
    camera.position.x = radius * Math.sin( theta * Math.PI / 360 ) * Math.cos( phi * Math.PI / 360 );
    camera.position.y = radius * Math.sin( phi * Math.PI / 360 );
    camera.position.z = radius * Math.cos( theta * Math.PI / 360 ) * Math.cos( phi * Math.PI / 360 );
    camera.target = new THREE.Vector3(0, 0, 0);
    camera.lookAt(camera.target);
    camera.updateMatrix();
    scene.add( camera );

    // axis
    if (r3jsdata.options.axisbox) 
	scene.add( new THREE.Mesh( new THREE.CubeGeometry( 1, 1, 1 ), 
				   new THREE.MeshBasicMaterial( { color: 0x000000, wireframe: true } )) );

    if (r3jsdata.options.axisline) {
	var origin = new THREE.Vertex(new THREE.Vector3(0,0,0));
	var axisx = new THREE.Geometry();
	axisx.vertices.push(origin);
	axisx.vertices.push(new THREE.Vertex( new THREE.Vector3(1,0,0)));
	scene.add(new THREE.Line( axisx, new THREE.LineBasicMaterial( { color: 0xff0000, opacity: 1, linewidth: 5} )));

	var axisy = new THREE.Geometry();
	axisy.vertices.push(origin);
	axisy.vertices.push(new THREE.Vertex( new THREE.Vector3(0,1,0)));
	scene.add(new THREE.Line( axisy, new THREE.LineBasicMaterial( { color: 0x00ff00, opacity: 1, linewidth: 5} )));

	var axisz = new THREE.Geometry();
	axisz.vertices.push(origin);
	axisz.vertices.push(  new THREE.Vertex( new THREE.Vector3(0,0,1)));
	scene.add(new THREE.Line( axisz, new THREE.LineBasicMaterial( { color: 0x0000ff, opacity: 1, linewidth: 5} )));
    }

    // light
    pointLight = new THREE.PointLight( 0xFFFFFF );
    pointLight.position = new THREE.Vector3(3, 3, 3);
    scene.add(pointLight);
    pointLight = new THREE.PointLight( 0xFFFFFF );
    pointLight.position = new THREE.Vector3(-3, -3, -3);
    scene.add(pointLight);

    // mouse 
    document.addEventListener( 'mousedown', onDocumentMouseDown, false );
    document.addEventListener( 'mouseup', function(e){mousedown = false;}, false );
    document.addEventListener( 'mousemove', onDocumentMouseMove, false );
    onMouseDownPosition = new THREE.Vector2();

    // renderer
    renderer = new THREE.WebGLRenderer( { antialias: true } );
    renderer.setSize( window.innerWidth, window.innerHeight );
    container.appendChild( renderer.domElement );

    // data
    var segments = 16, rings = 16;
    for (var i = 0; i < r3jsdata.values.length; ++i) {
	var p = r3jsdata.values[i];
	switch(p.type) {
	case "sphere":
	    for ( var j = 0; j < p.n; j ++ ) {
		var sphere = new THREE.Mesh(new THREE.SphereGeometry(p.r[j], segments, rings), new THREE.MeshLambertMaterial({ opacity: p.alpha[j], color: p.col[j]}));
		sphere.position = new THREE.Vector3(p.x[j], p.y[j], p.z[j]);
		scene.add(sphere);
	    }
	    break;
	case "line":
	    var line = new THREE.Geometry();
	    var colors = [];
	    for ( var j = 0; j < p.n; ++ j) {
		line.vertices[j] = new THREE.Vertex( new THREE.Vector3(p.x[j], p.y[j], p.z[j]))
		colors[j] = new THREE.Color(p.col[j]);
	    }
	    line.colors = colors;
	    var material = new THREE.LineBasicMaterial( { color: 0xffffff, opacity: p.alpha, linewidth: p.lwd} );
	    material.vertexColors = true;
	    scene.add(new THREE.Line( line, material));
	    break;
	case "lathe":

	    var points = [];
	    for ( var j = 0; j < p.n; ++ j ) {
		points.push(new THREE.Vector3(p.x[j], p.y[j], p.z[j]))
	    }
	    var object = THREE.SceneUtils.createMultiMaterialObject( new THREE.LatheGeometry( points, 2 ), 
								     [new THREE.MeshLambertMaterial({ opacity: p.alpha, color: p.col}),
								      new THREE.MeshBasicMaterial( { color: 0x000000, wireframe: true, opacity: 1 } )]);
	    object.children[ 0 ].doubleSided = true;
	    object.position.set( 0, 0, 0 );
	    scene.add( object );
	}
    }
}

function onDocumentMouseDown( event ) {
    event.preventDefault();
    onMouseDownTheta = theta;
    onMouseDownPhi = phi;
    onMouseDownPosition.x = event.clientX;
    onMouseDownPosition.y = event.clientY;
    mousedown = true;
}

function onDocumentMouseMove( event ) {
    event.preventDefault();
    if ( mousedown ) {
        theta = - ( ( event.clientX - onMouseDownPosition.x ) * 0.5 ) + onMouseDownTheta;
        phi = ( ( event.clientY - onMouseDownPosition.y ) * 0.5 ) + onMouseDownPhi;
        camera.position.x = radius * Math.sin( theta * Math.PI / 360 ) * Math.cos( phi * Math.PI / 360 );
        camera.position.y = radius * Math.sin( phi * Math.PI / 360 );
        camera.position.z = radius * Math.cos( theta * Math.PI / 360 ) * Math.cos( phi * Math.PI / 360 );
	camera.lookAt(camera.target);
        camera.updateMatrix();
	pointLight.position.x = camera.position.x;
	pointLight.position.y = camera.position.y + 3;
	pointLight.position.z = camera.position.z;
	render();
    }
}

function render() {
    renderer.render( scene, camera );
}


      </script>
  </body>
</html>
